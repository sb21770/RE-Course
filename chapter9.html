<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 9: Static Analysis Tools</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #131a2b;
            --bg-card: #1a2235;
            --accent-primary: #00ff88;
            --accent-secondary: #00b4d8;
            --accent-warning: #ff6b35;
            --text-primary: #e8e8e8;
            --text-secondary: #a0a0a0;
            --border-color: #2a3548;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.9; }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        nav { background: var(--bg-secondary); padding: 1rem 2rem; border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 100; }
        nav a { color: var(--accent-primary); text-decoration: none; }
        .chapter-header { background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-secondary) 100%); padding: 4rem 2rem; text-align: center; border-bottom: 1px solid var(--border-color); }
        .chapter-number { display: inline-block; background: linear-gradient(135deg, #00ff88 0%, #00b4d8 100%); color: var(--bg-primary); padding: 0.5rem 1.5rem; border-radius: 30px; font-weight: 700; margin-bottom: 1rem; }
        h1 { font-size: 2.5rem; margin-bottom: 1rem; background: linear-gradient(135deg, #00ff88 0%, #00b4d8 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .subtitle { color: var(--text-secondary); font-size: 1.1rem; }
        .content { padding: 3rem 0; }
        h2 { font-size: 1.8rem; color: var(--accent-primary); margin: 3rem 0 1.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-color); }
        h3 { font-size: 1.3rem; color: var(--accent-secondary); margin: 2rem 0 1rem; }
        p { margin-bottom: 1.5rem; }
        .definition { background: var(--bg-card); border-left: 4px solid var(--accent-primary); padding: 1.5rem; border-radius: 0 10px 10px 0; margin: 1.5rem 0; }
        .definition-title { color: var(--accent-primary); font-weight: 700; font-size: 1.1rem; margin-bottom: 0.5rem; }
        .info-box { background: rgba(0, 180, 216, 0.1); border: 1px solid var(--accent-secondary); border-radius: 10px; padding: 1.5rem; margin: 1.5rem 0; }
        .info-box-title { color: var(--accent-secondary); font-weight: 700; margin-bottom: 0.5rem; }
        ul, ol { margin: 1rem 0 1.5rem 1.5rem; }
        li { margin-bottom: 0.8rem; }
        code { font-family: 'Fira Code', monospace; background: var(--bg-card); padding: 0.2rem 0.5rem; border-radius: 4px; color: var(--accent-primary); font-size: 0.9rem; }
        pre { font-family: 'Fira Code', monospace; background: var(--bg-card); padding: 1.5rem; border-radius: 10px; overflow-x: auto; margin: 1.5rem 0; border: 1px solid var(--border-color); line-height: 1.6; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; background: var(--bg-card); border-radius: 10px; overflow: hidden; }
        th, td { padding: 1rem; text-align: left; border-bottom: 1px solid var(--border-color); }
        th { background: var(--bg-secondary); color: var(--accent-primary); font-weight: 600; }
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 4rem; padding-top: 2rem; border-top: 1px solid var(--border-color); }
        .nav-btn { background: var(--bg-card); color: var(--text-primary); padding: 1rem 2rem; border-radius: 10px; text-decoration: none; border: 1px solid var(--border-color); transition: all 0.3s; }
        .nav-btn:hover { border-color: var(--accent-primary); transform: translateY(-3px); }
        .tool-card { background: var(--bg-card); border-radius: 15px; padding: 2rem; margin: 2rem 0; border: 1px solid var(--border-color); }
        .tool-name { color: var(--accent-primary); font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem; }
        .tool-type { color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem; }
        .shortcut-table td:first-child { font-family: 'Fira Code', monospace; color: var(--accent-secondary); }
    </style>
</head>
<body>
    <nav>
        <a href="index.html">‚Üê Back to Main Menu</a>
    </nav>

    <header class="chapter-header">
        <div class="chapter-number">Chapter 9</div>
        <h1>Static Analysis Tools</h1>
        <p class="subtitle">Working with IDA Pro and Ghidra</p>
    </header>

    <div class="container">
        <div class="content">
            
            <h2>üî¨ What is Static Analysis?</h2>

            <div class="definition">
                <div class="definition-title">üìñ Definition: Static Analysis</div>
                <p>Analyzing software <strong>without running it</strong>. Reading the code, understanding the structure, and identifying functions and variables.</p>
            </div>

            <p>Advantages:</p>
            <ul>
                <li>Safe - no risk from running malicious code</li>
                <li>See all the code, including parts that don't always run</li>
                <li>Allows understanding the overall structure</li>
            </ul>

            <p>Disadvantages:</p>
            <ul>
                <li>Code can be encrypted or packed</li>
                <li>Can't see runtime values</li>
                <li>Hard to follow dynamic code</li>
            </ul>

            <div class="tool-card">
                <div class="tool-name">üî∑ IDA Pro</div>
                <div class="tool-type">Interactive DisAssembler - The Industry Standard</div>
                <p>
                    The most popular tool for static analysis. Expensive (~$2000+) but very powerful.
                    There's a free version (<strong>IDA Free</strong>) with limited capabilities.
                </p>
                <ul>
                    <li>Excellent disassembler with automatic recognition</li>
                    <li>Decompiler (Hex-Rays) - converts to C</li>
                    <li>Support for many architectures</li>
                    <li>Python scripting (IDAPython)</li>
                </ul>
            </div>

            <div class="tool-card">
                <div class="tool-name">üêâ Ghidra</div>
                <div class="tool-type">NSA's Reverse Engineering Tool - Free and Open Source!</div>
                <p>
                    Released in 2019 by the NSA. <strong>Completely free</strong> and competes with IDA.
                </p>
                <ul>
                    <li>Built-in decompiler (unlike IDA Free)</li>
                    <li>Open source - can be extended</li>
                    <li>Support for various formats and architectures</li>
                    <li>Scripting in Java and Python</li>
                    <li><strong>Recommended for beginners!</strong></li>
                </ul>
            </div>

            <h2>üöÄ Getting Started with Ghidra</h2>

            <h3>Installation</h3>
            <ol>
                <li>Install Java JDK 17+</li>
                <li>Download from <code>ghidra-sre.org</code></li>
                <li>Extract and run <code>ghidraRun.bat</code> (Windows)</li>
            </ol>

            <h3>Importing a File</h3>
            <ol>
                <li>Create a new Project: File ‚Üí New Project</li>
                <li>Import a file: File ‚Üí Import File</li>
                <li>Ghidra will auto-detect the format</li>
                <li>Click Yes for Auto Analysis</li>
                <li>Open in CodeBrowser (double-click)</li>
            </ol>

            <h3>Main Windows</h3>

            <table>
                <tr>
                    <th>Window</th>
                    <th>Purpose</th>
                </tr>
                <tr>
                    <td><strong>Listing</strong></td>
                    <td>Assembly code - the main view</td>
                </tr>
                <tr>
                    <td><strong>Decompiler</strong></td>
                    <td>Reconstructed C code - more readable!</td>
                </tr>
                <tr>
                    <td><strong>Symbol Tree</strong></td>
                    <td>List of functions, imports, exports</td>
                </tr>
                <tr>
                    <td><strong>Data Type Manager</strong></td>
                    <td>Data types and structures</td>
                </tr>
                <tr>
                    <td><strong>Functions</strong></td>
                    <td>List of all functions</td>
                </tr>
            </table>

            <h3>Important Keyboard Shortcuts</h3>

            <table class="shortcut-table">
                <tr>
                    <th>Shortcut</th>
                    <th>Action</th>
                </tr>
                <tr>
                    <td>G</td>
                    <td>Go to Address - jump to address</td>
                </tr>
                <tr>
                    <td>L</td>
                    <td>Rename - change name</td>
                </tr>
                <tr>
                    <td>;</td>
                    <td>Add comment</td>
                </tr>
                <tr>
                    <td>X</td>
                    <td>Cross References - where is this used</td>
                </tr>
                <tr>
                    <td>Ctrl+Shift+E</td>
                    <td>Search text</td>
                </tr>
                <tr>
                    <td>D</td>
                    <td>Convert to Data</td>
                </tr>
                <tr>
                    <td>C</td>
                    <td>Convert to Code</td>
                </tr>
            </table>

            <h2>üî∑ Getting Started with IDA</h2>

            <h3>IDA Keyboard Shortcuts</h3>

            <table class="shortcut-table">
                <tr>
                    <th>Shortcut</th>
                    <th>Action</th>
                </tr>
                <tr>
                    <td>G</td>
                    <td>Jump to address</td>
                </tr>
                <tr>
                    <td>N</td>
                    <td>Rename</td>
                </tr>
                <tr>
                    <td>;</td>
                    <td>Add comment</td>
                </tr>
                <tr>
                    <td>X</td>
                    <td>Cross References</td>
                </tr>
                <tr>
                    <td>Space</td>
                    <td>Toggle between Graph and Text view</td>
                </tr>
                <tr>
                    <td>F5</td>
                    <td>Decompile (if Hex-Rays available)</td>
                </tr>
                <tr>
                    <td>Esc</td>
                    <td>Go back</td>
                </tr>
                <tr>
                    <td>Ctrl+E</td>
                    <td>Entry Points</td>
                </tr>
            </table>

            <h2>üéØ Analysis Tips</h2>

            <div class="info-box">
                <div class="info-box-title">üí° Recommended Analysis Steps</div>
                <ol>
                    <li><strong>Imports</strong> - What does the program use? (CreateFile, socket, RegOpenKey...)</li>
                    <li><strong>Strings</strong> - Search for interesting text (URLs, errors, messages)</li>
                    <li><strong>Entry Point</strong> - Start from the entry point</li>
                    <li><strong>Cross References</strong> - Follow calls to interesting functions</li>
                    <li><strong>Rename</strong> - Give meaningful names to functions</li>
                    <li><strong>Comments</strong> - Document what you understand</li>
                </ol>
            </div>

            <h3>Searching for Strings</h3>

            <p><strong>Ghidra:</strong> Search ‚Üí For Strings</p>
            <p><strong>IDA:</strong> View ‚Üí Open Subviews ‚Üí Strings (or Shift+F12)</p>

            <p>Look for:</p>
            <ul>
                <li>URLs, IPs, Domain names</li>
                <li>File paths</li>
                <li>Error messages</li>
                <li>Registry keys</li>
                <li>API function names</li>
            </ul>

            <h3>Cross References (XRefs)</h3>

            <div class="definition">
                <div class="definition-title">üìñ Definition: Cross Reference</div>
                <p>A link between locations in the code. "Where is this function called from?" or "Where is this variable used?"</p>
            </div>

            <pre>
; Let's say we have a function decrypt()
; XRefs will show us all places that call it:

00401100: call decrypt     ; XRef #1
00401250: call decrypt     ; XRef #2
00401380: call decrypt     ; XRef #3
            </pre>

            <h2>üîÑ Decompiler</h2>

            <div class="definition">
                <div class="definition-title">üìñ Definition: Decompiler</div>
                <p>A tool that converts Assembly back to C code (approximately). Makes understanding the logic much easier!</p>
            </div>

            <p>In Ghidra, the Decompiler is built-in. In IDA, you need the Hex-Rays plugin (expensive).</p>

            <pre>
; Assembly
push ebp
mov ebp, esp
sub esp, 8
mov dword [ebp-4], 0
jmp check
loop:
    mov eax, [ebp-4]
    add eax, 1
    mov [ebp-4], eax
check:
    cmp dword [ebp-4], 10
    jl loop
...

// Decompiled C
int counter = 0;
while (counter < 10) {
    counter++;
}
            </pre>

            <div class="info-box">
                <div class="info-box-title">‚ö†Ô∏è Important to Remember</div>
                <p>
                    Decompiler isn't perfect! The reconstructed code:<br>
                    - Isn't always 100% accurate<br>
                    - Variable names are generic (var1, param_1)<br>
                    - Structures and types aren't always identified correctly<br>
                    - Good to verify against Assembly
                </p>
            </div>

            <h2>üìã Chapter Summary</h2>
            
            <ul>
                <li><strong>Static Analysis</strong> - analysis without running</li>
                <li><strong>IDA Pro</strong> - the professional tool (expensive)</li>
                <li><strong>Ghidra</strong> - free and recommended for beginners!</li>
                <li><strong>Decompiler</strong> - conversion to C for easy reading</li>
                <li>Start with Imports and Strings</li>
                <li>Use XRefs to follow the code</li>
                <li>Rename and add comments!</li>
            </ul>

            <div class="nav-buttons">
                <a href="chapter8.html" class="nav-btn">‚Üê Chapter 8: Calling Conventions</a>
                <a href="chapter10.html" class="nav-btn">Chapter 10: Debugging ‚Üí</a>
            </div>
        </div>
    </div>
</body>
</html>
