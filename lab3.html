<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 3: Crackme Challenge</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #131a2b;
            --bg-card: #1a2235;
            --accent-primary: #00ff88;
            --accent-secondary: #00b4d8;
            --accent-warning: #ff6b35;
            --text-primary: #e8e8e8;
            --text-secondary: #a0a0a0;
            --border-color: #2a3548;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.9; }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        nav { background: var(--bg-secondary); padding: 1rem 2rem; border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 100; }
        nav a { color: var(--accent-primary); text-decoration: none; }
        .chapter-header { background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%); padding: 4rem 2rem; text-align: center; }
        .chapter-number { display: inline-block; background: rgba(0,0,0,0.3); color: white; padding: 0.5rem 1.5rem; border-radius: 30px; font-weight: 700; margin-bottom: 1rem; }
        h1 { font-size: 2.5rem; margin-bottom: 1rem; color: white; }
        .subtitle { color: rgba(255,255,255,0.9); font-size: 1.1rem; }
        .content { padding: 3rem 0; }
        h2 { font-size: 1.8rem; color: var(--accent-warning); margin: 3rem 0 1.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-color); }
        h3 { font-size: 1.3rem; color: var(--accent-secondary); margin: 2rem 0 1rem; }
        p { margin-bottom: 1.5rem; }
        .info-box { background: rgba(0, 180, 216, 0.1); border: 1px solid var(--accent-secondary); border-radius: 10px; padding: 1.5rem; margin: 1.5rem 0; }
        .info-box-title { color: var(--accent-secondary); font-weight: 700; margin-bottom: 0.5rem; }
        .task-box { background: rgba(255, 107, 53, 0.1); border: 1px solid var(--accent-warning); border-radius: 10px; padding: 1.5rem; margin: 1.5rem 0; }
        .task-title { color: var(--accent-warning); font-weight: 700; margin-bottom: 0.5rem; font-size: 1.1rem; }
        .hint-box { background: rgba(0, 255, 136, 0.1); border: 1px solid var(--accent-primary); border-radius: 10px; padding: 1.5rem; margin: 1.5rem 0; }
        .hint-title { color: var(--accent-primary); font-weight: 700; margin-bottom: 0.5rem; cursor: pointer; }
        .hint-content { display: none; margin-top: 0.5rem; }
        ul, ol { margin: 1rem 0 1.5rem 1.5rem; }
        li { margin-bottom: 0.8rem; }
        code { font-family: 'Fira Code', monospace; background: var(--bg-card); padding: 0.2rem 0.5rem; border-radius: 4px; color: var(--accent-primary); font-size: 0.9rem; }
        pre { font-family: 'Fira Code', monospace; background: var(--bg-card); padding: 1.5rem; border-radius: 10px; overflow-x: auto; margin: 1.5rem 0; border: 1px solid var(--border-color); direction: ltr; text-align: left; line-height: 1.6; }
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 4rem; padding-top: 2rem; border-top: 1px solid var(--border-color); }
        .nav-btn { background: var(--bg-card); color: var(--text-primary); padding: 1rem 2rem; border-radius: 10px; text-decoration: none; border: 1px solid var(--border-color); transition: all 0.3s; }
        .nav-btn:hover { border-color: var(--accent-warning); transform: translateY(-3px); }
        .warning-box { background: rgba(255, 107, 53, 0.2); border: 2px solid var(--accent-warning); border-radius: 10px; padding: 1.5rem; margin: 1.5rem 0; }
        .warning-title { color: var(--accent-warning); font-weight: 700; margin-bottom: 0.5rem; }
    </style>
</head>
<body>
    <nav>
        <a href="index.html">‚Üê Back to Main Menu</a>
    </nav>

    <header class="chapter-header">
        <div class="chapter-number">üîß Lab 3</div>
        <h1>Crackme Challenge</h1>
        <p class="subtitle">Solving a classic RE challenge - finding the password</p>
    </header>

    <div class="container">
        <div class="content">
            
            <h2>üéØ What is a Crackme?</h2>
            
            <p>
                A <strong>Crackme</strong> is a program created specifically for RE practice. The goal: find the correct password or bypass the authorization check.
            </p>
            
            <p>This is a common practice in the RE community and there are thousands of crackmes at various difficulty levels.</p>

            <h2>üì• Where to Find Crackmes</h2>
            
            <ul>
                <li><strong>crackmes.one</strong> - The most popular site</li>
                <li><strong>reversing.kr</strong> - Advanced challenges</li>
                <li><strong>challenges.re</strong> - Wide variety</li>
            </ul>

            <div class="warning-box">
                <div class="warning-title">‚ö†Ô∏è Warning</div>
                <p>
                    Always download crackmes only from trusted sources!<br>
                    It's recommended to run in a VM in case someone hid malware.
                </p>
            </div>

            <h2>üî¨ Example Crackme</h2>

            <p>Let's analyze the following pseudo-code (the code you'll see in Ghidra):</p>

            <pre>
int main() {
    char input[32];
    
    printf("Enter password: ");
    scanf("%s", input);
    
    if (check_password(input)) {
        printf("Access Granted!\n");
    } else {
        printf("Wrong password!\n");
    }
    return 0;
}

int check_password(char* password) {
    if (strlen(password) != 8) return 0;
    
    if (password[0] != 'S') return 0;
    if (password[1] != 'E') return 0;
    if (password[2] != 'C') return 0;
    if (password[3] != 'R') return 0;
    if (password[4] != 'E') return 0;
    if (password[5] != 'T') return 0;
    if (password[6] != '1') return 0;
    if (password[7] != '2') return 0;
    
    return 1;
}
            </pre>

            <div class="task-box">
                <div class="task-title">Task: Find the Password!</div>
                <p>What is the correct password?</p>
                <div class="hint-box">
                    <div class="hint-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üí° Show Answer
                    </div>
                    <div class="hint-content">
                        The password is: <code>SECRET12</code>
                    </div>
                </div>
            </div>

            <h2>üîç Approaches to Solving Crackmes</h2>

            <h3>Approach 1: Static Analysis (Ghidra)</h3>
            <ol>
                <li>Open the file in Ghidra</li>
                <li>Find <code>main</code> or the Entry Point</li>
                <li>Search for calls to <code>strcmp</code>, <code>memcmp</code></li>
                <li>Search for interesting strings ("password", "correct"...)</li>
                <li>Follow the logic of the password check</li>
            </ol>

            <h3>Approach 2: Dynamic Analysis (x64dbg)</h3>
            <ol>
                <li>Open the file in x64dbg</li>
                <li>Set BP on comparison functions:
                    <pre>bp strcmp
bp memcmp
bp lstrcmpA</pre>
                </li>
                <li>Run (F9) and enter any password</li>
                <li>When stopped at BP, check the parameters on the Stack</li>
                <li>The correct password will be in one of the parameters!</li>
            </ol>

            <h3>Approach 3: Patching</h3>
            <p>Instead of finding the password, you can modify the code:</p>
            
            <pre>
; before patch
cmp eax, 0
jne wrong_password    ; JNE = 0x75

; after patch - always succeeds
cmp eax, 0
je  wrong_password    ; JE = 0x74
; or:
nop                   ; NOP = 0x90
nop
            </pre>

            <h2>üìù Practical Exercise</h2>

            <div class="task-box">
                <div class="task-title">Exercise: Analyze the Assembly Below</div>
                <p>This is real check_password code. What is the password?</p>
                <pre>
check_password:
    push ebp
    mov ebp, esp
    mov eax, [ebp+8]        ; EAX = password pointer
    
    ; Check length
    push eax
    call strlen
    add esp, 4
    cmp eax, 4
    jne fail
    
    ; Check char 0
    mov eax, [ebp+8]
    movzx eax, byte [eax]
    cmp al, 0x41            ; 'A' = 0x41
    jne fail
    
    ; Check char 1
    mov eax, [ebp+8]
    movzx eax, byte [eax+1]
    cmp al, 0x42            ; 'B' = 0x42
    jne fail
    
    ; Check char 2
    mov eax, [ebp+8]
    movzx eax, byte [eax+2]
    cmp al, 0x43            ; 'C' = 0x43
    jne fail
    
    ; Check char 3
    mov eax, [ebp+8]
    movzx eax, byte [eax+3]
    cmp al, 0x44            ; 'D' = 0x44
    jne fail
    
    mov eax, 1              ; success
    jmp done
    
fail:
    mov eax, 0
    
done:
    pop ebp
    ret
                </pre>
            </div>

            <div class="hint-box">
                <div class="hint-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                    üí° Hint 1 - ASCII Table
                </div>
                <div class="hint-content">
                    0x41 = 'A', 0x42 = 'B', 0x43 = 'C', 0x44 = 'D'
                </div>
            </div>

            <div class="hint-box">
                <div class="hint-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                    üí° Answer
                </div>
                <div class="hint-content">
                    The password is: <code>ABCD</code><br>
                    Length 4, and the characters are A, B, C, D in order.
                </div>
            </div>

            <h2>üéØ Bonus Task</h2>

            <div class="task-box">
                <div class="task-title">Challenge: Download and Solve a Real Crackme</div>
                <ol>
                    <li>Go to <code>crackmes.one</code></li>
                    <li>Search for a crackme with rating 1-2 (easy)</li>
                    <li>Download and analyze</li>
                    <li>Find the password or bypass the check</li>
                </ol>
                <p>Recommended crackmes for beginners:</p>
                <ul>
                    <li>Search for "easy" or "beginner" in the description</li>
                    <li>Start with Windows crackmes (PE)</li>
                    <li>32-bit is better to start with</li>
                </ul>
            </div>

            <h2>üìã Tips for Solving Crackmes</h2>

            <div class="info-box">
                <div class="info-box-title">üí° General Strategy</div>
                <ol>
                    <li><strong>Search for Strings</strong> - "wrong", "correct", "password"</li>
                    <li><strong>Search for Imports</strong> - strcmp, MessageBox</li>
                    <li><strong>Find the decision point</strong> - where does the code decide to succeed or fail</li>
                    <li><strong>Trace backwards</strong> - where does the checked value come from?</li>
                    <li><strong>Set BP</strong> - on comparison functions and input checking</li>
                </ol>
            </div>

            <div class="nav-buttons">
                <a href="lab2.html" class="nav-btn">‚Üê Lab 2: Reading Assembly</a>
                <a href="lab4.html" class="nav-btn">Lab 4: PE Analysis ‚Üí</a>
            </div>
        </div>
    </div>
</body>
</html>
