<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 2: Reading Assembly</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #131a2b;
            --bg-card: #1a2235;
            --accent-primary: #00ff88;
            --accent-secondary: #00b4d8;
            --accent-warning: #ff6b35;
            --text-primary: #e8e8e8;
            --text-secondary: #a0a0a0;
            --border-color: #2a3548;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.9; }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        nav { background: var(--bg-secondary); padding: 1rem 2rem; border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 100; }
        nav a { color: var(--accent-primary); text-decoration: none; }
        .chapter-header { background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%); padding: 4rem 2rem; text-align: center; }
        .chapter-number { display: inline-block; background: rgba(0,0,0,0.3); color: white; padding: 0.5rem 1.5rem; border-radius: 30px; font-weight: 700; margin-bottom: 1rem; }
        h1 { font-size: 2.5rem; margin-bottom: 1rem; color: white; }
        .subtitle { color: rgba(255,255,255,0.9); font-size: 1.1rem; }
        .content { padding: 3rem 0; }
        h2 { font-size: 1.8rem; color: var(--accent-warning); margin: 3rem 0 1.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-color); }
        h3 { font-size: 1.3rem; color: var(--accent-secondary); margin: 2rem 0 1rem; }
        p { margin-bottom: 1.5rem; }
        .task-box { background: rgba(255, 107, 53, 0.1); border: 1px solid var(--accent-warning); border-radius: 10px; padding: 1.5rem; margin: 1.5rem 0; }
        .task-title { color: var(--accent-warning); font-weight: 700; margin-bottom: 0.5rem; font-size: 1.1rem; }
        .exercise-box { background: var(--bg-card); border: 2px solid var(--accent-secondary); border-radius: 10px; padding: 1.5rem; margin: 1.5rem 0; }
        .exercise-title { color: var(--accent-secondary); font-weight: 700; margin-bottom: 1rem; font-size: 1.1rem; }
        .answer-box { background: var(--bg-secondary); border-radius: 10px; padding: 1rem; margin-top: 1rem; }
        .answer-title { color: var(--accent-primary); font-weight: 700; cursor: pointer; }
        .answer-content { display: none; margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid var(--border-color); }
        ul, ol { margin: 1rem 0 1.5rem 1.5rem; }
        li { margin-bottom: 0.8rem; }
        code { font-family: 'Fira Code', monospace; background: var(--bg-card); padding: 0.2rem 0.5rem; border-radius: 4px; color: var(--accent-primary); font-size: 0.9rem; }
        pre { font-family: 'Fira Code', monospace; background: var(--bg-card); padding: 1.5rem; border-radius: 10px; overflow-x: auto; margin: 1.5rem 0; border: 1px solid var(--border-color); direction: ltr; text-align: left; line-height: 1.6; }
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 4rem; padding-top: 2rem; border-top: 1px solid var(--border-color); }
        .nav-btn { background: var(--bg-card); color: var(--text-primary); padding: 1rem 2rem; border-radius: 10px; text-decoration: none; border: 1px solid var(--border-color); transition: all 0.3s; }
        .nav-btn:hover { border-color: var(--accent-warning); transform: translateY(-3px); }
    </style>
</head>
<body>
    <nav>
        <a href="index.html">‚Üê Back to Main Menu</a>
    </nav>

    <header class="chapter-header">
        <div class="chapter-number">üîß Lab 2</div>
        <h1>Reading Assembly</h1>
        <p class="subtitle">Analyzing code snippets and understanding the logic</p>
    </header>

    <div class="container">
        <div class="content">
            
            <h2>üéØ Lab Objectives</h2>
            <ul>
                <li>Reading and understanding Assembly code</li>
                <li>Identifying common structures (if, loops, functions)</li>
                <li>Converting from Assembly to C</li>
            </ul>

            <h2>üìù Exercise 1: Data Movement</h2>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 1.1</div>
                <p>What will be the value of each register at the end?</p>
                <pre>
mov eax, 10
mov ebx, 20
mov ecx, eax
add ecx, ebx
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <code>EAX = 10</code><br>
                        <code>EBX = 20</code><br>
                        <code>ECX = 30</code> (10 + 20)
                    </div>
                </div>
            </div>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 1.2</div>
                <p>What will be the value of EAX at the end?</p>
                <pre>
mov eax, 100
sub eax, 25
add eax, 10
dec eax
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <code>EAX = 84</code><br>
                        100 - 25 = 75<br>
                        75 + 10 = 85<br>
                        85 - 1 = 84
                    </div>
                </div>
            </div>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 1.3</div>
                <p>What is the difference between these two lines?</p>
                <pre>
mov eax, [ebp-4]    ; Line A
lea eax, [ebp-4]    ; Line B
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <strong>Line A (MOV):</strong> Copies the <em>value</em> at address EBP-4 to EAX<br>
                        <strong>Line B (LEA):</strong> Copies the <em>address itself</em> (EBP-4) to EAX<br><br>
                        If EBP=0x1000 and the value at address 0x0FFC is 42:<br>
                        MOV: EAX = 42<br>
                        LEA: EAX = 0x0FFC
                    </div>
                </div>
            </div>

            <h2>üìù Exercise 2: Logical Operations</h2>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 2.1</div>
                <p>What will EAX be at the end? (Hint: work in binary)</p>
                <pre>
mov eax, 0xFF      ; 1111 1111
and eax, 0x0F      ; 0000 1111
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <code>EAX = 0x0F = 15</code><br>
                        AND keeps only the bits that are 1 in both operands:<br>
                        1111 1111 AND 0000 1111 = 0000 1111
                    </div>
                </div>
            </div>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 2.2</div>
                <p>What does this do?</p>
                <pre>
xor eax, eax
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <strong>Zeros out EAX!</strong><br>
                        XOR of a number with itself always gives 0.<br>
                        This is faster than <code>mov eax, 0</code>
                    </div>
                </div>
            </div>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 2.3</div>
                <p>What will EAX be?</p>
                <pre>
mov eax, 8        ; 0000 1000
shl eax, 2        ; shift left 2
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <code>EAX = 32</code><br>
                        SHL 2 = multiply by 4 (2¬≤)<br>
                        8 √ó 4 = 32<br>
                        In binary: 0000 1000 ‚Üí 0010 0000
                    </div>
                </div>
            </div>

            <h2>üìù Exercise 3: Identifying Conditions</h2>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 3.1</div>
                <p>Translate the following code to C:</p>
                <pre>
    cmp eax, 10
    jl  less_than
    mov ebx, 1
    jmp end
less_than:
    mov ebx, 0
end:
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <pre>
if (eax >= 10) {
    ebx = 1;
} else {
    ebx = 0;
}
                        </pre>
                        Or shortly: <code>ebx = (eax >= 10) ? 1 : 0;</code>
                    </div>
                </div>
            </div>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 3.2</div>
                <p>What does the following code check?</p>
                <pre>
    test eax, eax
    jnz  not_zero
    ; code A
    jmp end
not_zero:
    ; code B
end:
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <pre>
if (eax == 0) {
    // code A
} else {
    // code B
}
                        </pre>
                        TEST EAX, EAX sets ZF to 1 if EAX=0.<br>
                        JNZ = Jump if Not Zero = jumps if EAX ‚â† 0
                    </div>
                </div>
            </div>

            <h2>üìù Exercise 4: Loops</h2>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 4.1</div>
                <p>Translate to C and find the final value of EAX:</p>
                <pre>
    mov eax, 0
    mov ecx, 5
loop_start:
    add eax, ecx
    dec ecx
    jnz loop_start
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <pre>
int sum = 0;
for (int i = 5; i > 0; i--) {
    sum += i;
}
// sum = 5 + 4 + 3 + 2 + 1 = 15
                        </pre>
                        <code>EAX = 15</code>
                    </div>
                </div>
            </div>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 4.2</div>
                <p>What does this loop do?</p>
                <pre>
    mov ecx, 10
    mov esi, source
    mov edi, dest
copy_loop:
    mov al, [esi]
    mov [edi], al
    inc esi
    inc edi
    dec ecx
    jnz copy_loop
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <strong>Copies 10 bytes from address source to address dest!</strong><br>
                        In C: <code>memcpy(dest, source, 10);</code><br><br>
                        Each iteration:<br>
                        1. Reads a byte from source<br>
                        2. Writes it to dest<br>
                        3. Advances both pointers<br>
                        4. Continues until ECX=0
                    </div>
                </div>
            </div>

            <h2>üìù Exercise 5: Functions</h2>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 5.1</div>
                <p>What does this function calculate?</p>
                <pre>
func:
    push ebp
    mov ebp, esp
    
    mov eax, [ebp+8]     ; parameter 1
    mov ebx, [ebp+12]    ; parameter 2
    imul eax, ebx        ; EAX = EAX * EBX
    
    pop ebp
    ret
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <pre>
int func(int a, int b) {
    return a * b;
}
                        </pre>
                        The function multiplies two numbers and returns the result.
                    </div>
                </div>
            </div>

            <div class="exercise-box">
                <div class="exercise-title">Exercise 5.2 - Challenge!</div>
                <p>What does this function do? (Hint: famous recursive function)</p>
                <pre>
mystery:
    push ebp
    mov ebp, esp
    
    mov eax, [ebp+8]      ; n
    cmp eax, 1
    jle base_case
    
    ; recursive case
    dec eax
    push eax
    call mystery
    add esp, 4
    
    mov ebx, [ebp+8]
    imul eax, ebx
    jmp done
    
base_case:
    mov eax, 1
    
done:
    pop ebp
    ret
                </pre>
                <div class="answer-box">
                    <div class="answer-title" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        üëÅÔ∏è Show Answer
                    </div>
                    <div class="answer-content">
                        <strong>This is the Factorial function!</strong>
                        <pre>
int factorial(int n) {
    if (n <= 1) {
        return 1;
    }
    return n * factorial(n - 1);
}
                        </pre>
                        factorial(5) = 5 √ó 4 √ó 3 √ó 2 √ó 1 = 120
                    </div>
                </div>
            </div>

            <h2>‚úÖ Summary</h2>
            <p>After these exercises, you should feel more comfortable with:</p>
            <ul>
                <li>Reading MOV, ADD, SUB, AND, XOR, SHL instructions</li>
                <li>Identifying conditions (CMP + Jxx)</li>
                <li>Identifying loops</li>
                <li>Understanding function structures</li>
            </ul>

            <div class="nav-buttons">
                <a href="lab1.html" class="nav-btn">‚Üê Lab 1: Getting to Know the Tools</a>
                <a href="lab3.html" class="nav-btn">Lab 3: Crackme Challenge ‚Üí</a>
            </div>
        </div>
    </div>
</body>
</html>
